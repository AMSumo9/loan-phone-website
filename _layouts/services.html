<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>{{ page.title | default: site.seo.default_title }}</title>
    <meta name="description" content="{{ page.meta_description | default: site.seo.default_description }}">
    <meta name="keywords" content="{{ page.meta_keywords | default: site.seo.default_keywords }}">
    
    <!-- Open Graph -->
    <meta property="og:title" content="{{ page.title | default: site.seo.default_title }}">
    <meta property="og:description" content="{{ page.meta_description | default: site.seo.default_description }}">
    <meta property="og:type" content="{{ page.og_type | default: 'website' }}">
    <meta property="og:url" content="{{ site.url }}{{ site.baseurl }}{{ page.url }}">
    <meta property="og:image" content="{{ site.url }}{{ site.baseurl }}{{ page.hero_image | default: site.seo.fallback_image }}">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ page.title | default: site.seo.default_title }}">
    <meta name="twitter:description" content="{{ page.meta_description | default: site.seo.default_description }}">
    <meta name="twitter:image" content="{{ site.url }}{{ site.baseurl }}{{ page.hero_image | default: site.seo.fallback_image }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ site.baseurl }}/assets/images/favicon.ico">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-red: #DC2626;
            --dark-red: #B91C1C;
            --light-red: #FEF2F2;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
        }
        
        .font-heading {
            font-family: 'Poppins', sans-serif;
        }
        
        .text-primary { color: var(--primary-red) !important; }
        .bg-primary { background-color: var(--primary-red) !important; }
        .border-primary { border-color: var(--primary-red) !important; }
        .hover\:bg-primary:hover { background-color: var(--primary-red) !important; }
        .hover\:text-primary:hover { color: var(--primary-red) !important; }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--dark-red) 100%);
            min-height: 300px;
        }
        
        .service-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .service-card:hover {
            border-left-color: var(--primary-red);
            transform: translateY(-2px);
        }
        
        .content-area {
            font-size: 16px;
            line-height: 1.7;
        }
        
        .content-area h1,
        .content-area h2,
        .content-area h3,
        .content-area h4 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #1F2937;
        }
        
        .content-area h1 { font-size: 2.5rem; }
        .content-area h2 { font-size: 2rem; }
        .content-area h3 { font-size: 1.5rem; }
        .content-area h4 { font-size: 1.25rem; }
        
        .content-area p {
            margin-bottom: 1.5rem;
            color: #374151;
        }
        
        .content-area ul,
        .content-area ol {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }
        
        .content-area li {
            margin-bottom: 0.5rem;
            color: #374151;
        }
        
        .quick-facts,
        .key-benefits {
            background: var(--light-red);
            border: 1px solid #FEE2E2;
        }
        
        .cta-section {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--dark-red) 100%);
        }
        
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary-red);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-to-top:hover {
            background: var(--dark-red);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Header -->
    {% include header.html %}
    
    <!-- Hero Section for Individual Service Pages -->
    {% if page.layout == 'services' and page.service_type %}
    <div class="hero-section text-white relative overflow-hidden">
        <div class="absolute inset-0 bg-black opacity-10"></div>
        <div class="container mx-auto px-4 py-16 relative z-10">
            <div class="max-w-4xl mx-auto text-center">
                <!-- Breadcrumbs -->
                <nav class="text-white/80 text-sm mb-6">
                    <a href="{{ site.baseurl }}/" class="hover:text-white">Home</a>
                    <span class="mx-2">></span>
                    <a href="{{ site.baseurl }}/services/" class="hover:text-white">Services</a>
                    <span class="mx-2">></span>
                    <span class="text-white">{{ page.service_type | default: "Service" }}</span>
                </nav>
                
                <h1 class="text-4xl md:text-5xl font-heading font-bold mb-6">
                    {% if page.hero_highlight %}
                        {{ page.title | replace: page.hero_highlight, '<span class="text-yellow-300">' | append: page.hero_highlight | append: '</span>' }}
                    {% else %}
                        {{ page.title | remove: ' | The Loan Phone' }}
                    {% endif %}
                </h1>
                
                {% if page.subtitle %}
                <p class="text-xl md:text-2xl mb-8 text-white/90">{{ page.subtitle }}</p>
                {% endif %}
                
                {% if page.excerpt %}
                <p class="text-lg mb-8 text-white/80 max-w-2xl mx-auto">{{ page.excerpt }}</p>
                {% endif %}
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="tel:{{ site.contact.phone }}" class="bg-white text-red-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition duration-300 inline-flex items-center justify-center">
                        <i class="fas fa-phone mr-2"></i>
                        Call {{ site.contact.phone_display }}
                    </a>
                    <button onclick="openSupportModal()" class="bg-transparent border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-red-600 transition duration-300 inline-flex items-center justify-center">
                        <i class="fas fa-comment mr-2"></i>
                        Get Free Quote
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        {% if page.layout == 'services' and page.service_type %}
            <!-- Individual Service Page Layout -->
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Main Content -->
                <div class="lg:w-2/3">
                    <div class="bg-white rounded-lg shadow-lg p-8 content-area">
                        {{ content }}
                    </div>
                </div>
                
                <!-- Sidebar -->
                <div class="lg:w-1/3">
                    <!-- Quick Facts -->
                    {% if page.quick_facts %}
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-6 quick-facts">
                        <h3 class="text-xl font-heading font-bold mb-4 text-primary">
                            <i class="fas fa-info-circle mr-2"></i>
                            Quick Facts
                        </h3>
                        <ul class="space-y-2">
                            {% for fact in page.quick_facts %}
                            <li class="flex items-start">
                                <i class="fas fa-check text-primary mr-2 mt-1 text-sm"></i>
                                <span>{{ fact }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    <!-- Key Benefits -->
                    {% if page.key_benefits %}
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-6 key-benefits">
                        <h3 class="text-xl font-heading font-bold mb-4 text-primary">
                            <i class="fas fa-star mr-2"></i>
                            Key Benefits
                        </h3>
                        <ul class="space-y-2">
                            {% for benefit in page.key_benefits %}
                            <li class="flex items-start">
                                <i class="fas fa-thumbs-up text-primary mr-2 mt-1 text-sm"></i>
                                <span>{{ benefit }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    <!-- Contact Card -->
                    <div class="bg-white rounded-lg shadow-lg p-6 cta-section text-white">
                        <h3 class="text-xl font-heading font-bold mb-4">
                            <i class="fas fa-headset mr-2"></i>
                            Need Help?
                        </h3>
                        <p class="mb-4">Speak to our loan specialists today for personalized advice.</p>
                        <div class="space-y-3">
                            <a href="tel:{{ site.contact.phone }}" class="block w-full bg-white text-red-600 text-center py-3 rounded-lg font-semibold hover:bg-gray-100 transition duration-300">
                                <i class="fas fa-phone mr-2"></i>
                                {{ site.contact.phone_display }}
                            </a>
                            <button onclick="openSupportModal()" class="block w-full bg-transparent border-2 border-white text-white text-center py-3 rounded-lg font-semibold hover:bg-white hover:text-red-600 transition duration-300">
                                <i class="fas fa-envelope mr-2"></i>
                                Email Us
                            </button>
                        </div>
                    </div>
                    
                    <!-- Related Services -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mt-6">
                        <h3 class="text-xl font-heading font-bold mb-4 text-primary">
                            <i class="fas fa-link mr-2"></i>
                            Related Services
                        </h3>
                        <div class="space-y-2">
                            {% assign related_services = site.services | where: "category", page.category | limit: 5 %}
                            {% for service in related_services %}
                                {% unless service.url == page.url %}
                                <a href="{{ site.baseurl }}{{ service.url }}" class="block p-3 rounded hover:bg-red-50 hover:text-primary transition duration-300">
                                    {% if service.icon %}<i class="{{ service.icon }} mr-2"></i>{% endif %}
                                    {{ service.title | remove: ' | The Loan Phone' }}
                                </a>
                                {% endunless %}
                            {% endfor %}
                            
                            <!-- Fallback to data file if no collection services -->
                            {% if related_services.size < 2 %}
                                {% for loan_type in site.data.loan_types.all_types limit: 5 %}
                                <a href="{{ site.baseurl }}{{ loan_type.url }}" class="block p-3 rounded hover:bg-red-50 hover:text-primary transition duration-300">
                                    <i class="fas fa-arrow-right mr-2"></i>
                                    {{ loan_type.name }}
                                </a>
                                {% endfor %}
                            {% endif %}
                        </div>
                        
                        <div class="mt-4 pt-4 border-t">
                            <a href="{{ site.baseurl }}/services/" class="text-primary hover:text-dark-red font-semibold">
                                <i class="fas fa-th-large mr-2"></i>
                                View All Services
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <!-- Services Index Page Layout -->
            <div class="content-area">
                {{ content }}
            </div>
        {% endif %}
    </main>
    
    <!-- Footer -->
    {% include footer.html %}
    
    <!-- Back to Top Button -->
    <div class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </div>
    
    <!-- JavaScript -->
    <script>
        // Back to top functionality
        window.addEventListener('scroll', function() {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.style.display = 'flex';
            } else {
                backToTop.style.display = 'none';
            }
        });
        
        document.getElementById('backToTop').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // Support modal function (to be defined in footer include)
        function openSupportModal() {
            const modal = document.getElementById('support-modal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
